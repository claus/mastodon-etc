---
type: app
title: Emojis Personalizados
publishedAt: '2022-11-26T12:00:00.000Z'
description: Emoji.
---

import { compressEmojiJSON } from 'utils';
import { resolveError } from 'utils/emoji';
import MDXPostLayout from 'components/ui/MDXPostLayout';
import EmojiPicker from 'components/ui/EmojiPicker';

# Emojis Personalizados da {props.domain}

<EmojiPicker
    categories={props.categories}
    baseUrl={props.baseUrl}
    status={props.status}
    statusText={props.statusText}
/>

export const getStaticProps = async ctx => {
    const fetchTimeout = 5;
    const postMeta = require('utils/posts').getPostMeta('emoji');
    const domain = ctx.params?.domain ?? 'mastodon.com.br';
    const api = `https://${domain}/api/v1/custom_emojis`;
    const getStaticPropsResponse = props => {
        return {
            revalidate: 60,
            props: {
                domain,
                status: 200,
                ...postMeta,
                ...props,
            },
        };
    };
    try {
        const controller = new AbortController();
        const timeoutId = setTimeout(
            () => controller.abort(),
            fetchTimeout * 1000
        );
        const response = await fetch(api, { signal: controller.signal });
        if (response.status >= 400) {
            return getStaticPropsResponse({
                status: response.status,
                statusText: `Error accessing Emoji API on ${domain} ("${response.statusText}")`,
            });
        }
        const json = await response.json();
        const { baseUrl, emojis: allEmojis } = compressEmojiJSON(json);
        const categories = allEmojis.reduce((acc, emoji) => {
            const { category = '' } = emoji;
            if (!acc[category]) acc[category] = [];
            acc[category].push(emoji);
            return acc;
        }, {});
        return getStaticPropsResponse({
            baseUrl,
            categories,
            status: response.status,
        });
    } catch (e) {
        return getStaticPropsResponse(resolveError(e, domain, fetchTimeout));
    }
};

export default ({ children, ...props }) => (
    <MDXPostLayout {...props}>{children}</MDXPostLayout>
);
